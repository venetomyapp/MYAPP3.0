<!DOCTYPE html>
<html lang="esso">
<testa>
    <meta charset="UTF-8">
    <meta nome="viewport" contenuto="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <titolo>Area Dirigenti - MyApp</titolo>

    <!-- Vento di coda CSS -->
    <scrittura src="https://cdn.tailwindcss.com"></scrittura>

    <!-- CONFIGURAZIONE COLORI TAILWIND -->
    <scrittura>
        vento contrario.confidenziale = {
            tema: {
                estendere: {
                    famiglia font: { intercalare: ['Inter','sans-serif'] },
                    colori: {
                        primario: '#1a1a2e',
                        secondario: '#16213e', 
                        accento: '#0f3460',
                        aurora: '#e94560',
                        ciano: '#00d4ff',
                        magenta: '#ff006e',
                        oro: '#ffd700',
                        alzavola: '#03dac6',
                        scuro: '#0a0a23',
                        luce: '#f8fafc',
                        successo: '#10b981',
                        testoDark: '#1C1C1E',
                        sfondoLuce: '#F4F4F8',
                    },
                    schermi: {
                        'xs': "320 px",
                        'sm': "640 px",
                        'md': "768px",
                        'Lg': "1024px",
                        'xl': "1280px",
                        '2xl': "1536px",
                    }
                }
            }
        }
    </scrittura>

    <!-- STILI MOBILE-FIRST -->
    <stile>
        :radice {
            --gradiente-aurora: gradiente lineare(135deg, #1a1a2e 0%, #16213e 25%, #0f3460 50%, #e94560 75%, #00d4ff 100%);
            --gradiente-magia: gradiente lineare(135deg, #ff006e 0%, #e94560 50%, #03dac6 100%);
            --area sicura-inserito-in alto: env(area sicura-inserita-in cima, 0);
            --area sicura-inserto-fondo: env(area sicura-inserito-in basso, 0);
            --area sicura-inserito-sinistra: env(area sicura-inserita-sinistra, 0);
            --area sicura-inserito-diritto: env(area sicura-inserita-destra, 0);
        }

        * {
            famiglia font: 'Inter', sans-serif;
            -webkit-tap-evidenzia-colore: trasparente;
            -webkit-touch-callout: nessuno;
        }

        corpo del corpo {
            sfondo: var(--gradiente-aurora);
            dimensione sfondo: 400% 400%;
            animazione: aurora 20s facilità infinita;
            altezza minima: 100vh;
            altezza minima: 100dvh;
            overflow-x: nascosto;
            imbottitura-sinistra: var(--area sicura-inserito-sinistra);
            diritto d'imbottitura: var(--area sicura-inserito-diritto);
        }

        @keyframes aurora {
            0%, 100% { posizione di sfondo: 0% 50%; }
            25% { posizione di sfondo: 100% 50%; }
            50% { posizione di sfondo: 100% 100%; }
            75% { posizione di sfondo: 0% 100%; }
        }

        @keyframes slideUp { da { opacità: 0; trasformare: traduci(20px); } a { opacità: 1; trasformare: traduci(0); } }
        @keyframes fadeIn { da { opacità: 0; } a { opacità: 1; } }
        @keyframes spin { 0% { trasformare: ruota(0deg); } 100% { trasformare: ruota(360deg); } }

        @media (movimenti preferiti-ridotti: ridurre) {
            * { animazione-durata: 0,01ms !importante; animazione-iterazione-conteggio: 1 !importante; transizione-durata: 0,01ms !importante; comportamento scroll: auto !importante; }
        }

        /* Tipografia */
        .testo-ultra-visibile {
            colore: #fff;
            testo-ombra: 0 8px 25px rgba(0,0,0,.9), 0 4px 12px rgba(0,0,0,.8), 0 2px 6px rgba(0,0,0,1);
            font-peso: 800;
        }

        .titolo dell'eroe {
            dimensione carattere: morsetto(1.8rem, 6vw, 3.5rem);
            font-peso: 900;
            altezza della linea: 1.1;
        }

        .sezione-titolo {
            dimensione carattere: morsetto(1.1rem, 4vw, 1.5rem);
            font-peso: 900;
            colore: #0f172a;
        }

        /* Carte */
        .carta di vetro {
            sfondo: #ffffff;
            confine: 1px solido rgba(0,0,0,.06);
            raggio di confine: 24px;
            box-ombra: 0 14px 30px rgba(0,0,0,.12);
        }

        /* Carte funzione - Mobile ottimizzato */
        .scheda funzione {
            sfondo: #f8fafc;
            confine: 1px solido #e5e7eb;
            raggio di confine: 20px;
            imbottitura: 1rem;
            transizione: tutto .25s facilità;
            allineare testo: centro;
            colore: #0f172a;
            testo-decorazione: nessuno;
            altezza minima: 120px;
            visualizzazione: flettere;
            direzione flex: colonna;
            allinea-elementi: centro;
            giustifica-contenuto: centro;
            posizione: relativo;
            troppo pieno: nascosto;
            touch-azione: manipolazione;
        }

        .scheda funzione::prima di {
            contenuto: ';
            posizione: assoluto;
            parte superiore: 0;
            sinistra: -100%;
            larghezza: 100%;
            altezza: 2px;
            sfondo: var(--gradiente-magia);
            transizione: sinistra 0,3s facilità;
        }

        .scheda funzione:attivo::prima di {
            sinistra: 0;
        }

        .scheda funzione:attivo {
            trasformare: scala(0,98);
        }

        @media (hover: hover) e (puntatore: bene) {
            .scheda funzione:hover {
                sfondo: #ffffff;
                trasformare: traduci(-3px);
                box-ombra: 0 10px 20px rgba(0,0,0,.12);
            }
        }

        .scheda funzione h4 {
            font-peso: 800;
            dimensione carattere: morsetto(0,9rem, 2.8vw, 1rem);
            margine-fondo: 0,25rem;
        }

        .scheda funzione biforcare {
            colore: #475569;
            dimensione carattere: 0,75rem;
            altezza della linea: 1.3;
        }

        /* Pulsanti */
        .btn-aurora {
            sfondo: var(--gradiente-magia);
            colore: #fff;
            confine: 0;
            raggio di confine: 12px;
            imbottitura: 0,75rem 1.25rem;
            font-peso: 800;
            visualizzazione: flessione in linea;
            allinea-elementi: centro;
            lacuna: 0,5rem;
            transizione: tutto .25s facilità;
            touch-azione: manipolazione;
            altezza minima: 44px;
        }

        @media (hover: hover) e (puntatore: bene) {
            .btn-aurora:hover {
                trasformare: traduci(-2px);
                box-ombra: 0 8px 16px rgba(233,69,96,.3);
            }
        }

        /* Distintivi */
        .distintivo {
            visualizzazione: blocco in linea;
            imbottitura: 0,25rem 0,6rem;
            raggio di confine: 9999px;
            sfondo: #111827;
            colore: #fff;
            dimensione carattere: 0,7rem;
            font-peso: 700;
        }

        /* Spinner */
        .filatore {
            confine: 3px solido rgba(0,0,0,.1);
            bordo-cima: 3px solido #111827;
            raggio di confine: 50%;
            larghezza: 22px;
            altezza: 22px;
            animazione: spin 1s infinito lineare;
            visualizzazione: blocco in linea;
        }

        /* Sistemi di rete mobile */
        .rete mobile-2 {
            visualizzazione: griglia;
            griglia-modello-colonne: ripetere(2, 1fr);
            lacuna: 12px;
        }

        @media (larghezza minima: 480px){
            .rete mobile-2 {
                griglia-modello-colonne: ripetere(3, 1fr);
                lacuna: 16px;
            }
        }

        @media (larghezza minima: 768px){
            .rete mobile-2 {
                griglia-modello-colonne: ripetere(4, 1fr);
                lacuna: 20px;
            }
        }

        @media (larghezza minima: 1024px){
            .rete mobile-2 {
                griglia-modello-colonne: ripetere(5, 1fr);
            }
        }

        .stats-grid {
            visualizzazione: griglia;
            griglia-modello-colonne: ripetere(2, 1fr);
            lacuna: 12px;
        }

        @media (larghezza minima: 640px){
            .stats-grid {
                griglia-modello-colonne: ripetere(4, 1fr);
                lacuna: 16px;
            }
        }

        .admin-grid {
            visualizzazione: griglia;
            griglia-modello-colonne: ripetere(1, 1fr);
            lacuna: 12px;
        }

        @media (larghezza minima: 640px){
            .admin-grid {
                griglia-modello-colonne: ripetere(2, 1fr);
            }
        }

        @media (larghezza minima: 1024px){
            .admin-grid {
                griglia-modello-colonne: ripetere(3, 1fr);
            }
        }

        .news-grid {
            visualizzazione: griglia;
            griglia-modello-colonne: ripetere(1, 1fr);
            lacuna: 16px;
        }

        @media (larghezza minima: 640px){
            .news-grid {
                griglia-modello-colonne: ripetere(2, 1fr);
            }
        }

        @media (larghezza minima: 1024px){
            .news-grid {
                griglia-modello-colonne: ripetere(3, 1fr);
            }
        }

        /* Intestazione con area sicura */
        .header-safe {
            imbottitura-top: max(12px, var(--area sicura-inserito-in alto));
        }

        /* Animazioni specifiche per dispositivi mobili */
        .scorrimento animato {
            animazione: scivola 0,3s disinvoltura;
        }

        .animate-fade-in {
            animazione: fadeIn 0,3s disinvoltura;
        }

        /* Sezioni mobili */
        .sezione mobile {
            imbottitura: 1rem;
        }

        @media (larghezza minima: 640px){
            .sezione mobile {
                imbottitura: 1.5rem;
            }
        }

        @media (larghezza minima: 1024px){
            .sezione mobile {
                imbottitura: 2rem;
            }
        }

        /* Stati focus */
        .scheda funzione:focus-visibile,
        pulsante:focus-visibile,
        [ruolo="bottone"]:focus-visibile {
            delineare: 3px solido rgba(0,212,255,.65);
            delineare-offset: 2px;
        }

        /* Toccare bersagli */
        .touch-target {
            altezza minima: 44px;
            larghezza minima: 44px;
        }

        /* Menu mobile */
        .menu mobile {
            trasformare: traduci(-100%);
            transizione: trasformare 0,3s facilità;
        }

        .menu mobile.mostra {
            trasformare: traduci(0);
        }

        /* Stile della barra di scorrimento */
        ::-webkit-scrollbar { larghezza: 6px; altezza: 6px; }
        ::-webkit-scrollbar-pollice { sfondo: rgba(255,255,255,.25); raggio di confine: 9999px; }
        ::-webkit-scrollbar-pollice:hover { sfondo: rgba(255,255,255,.4); }
        ::-traccia della barra di scorrimento Webkit { sfondo: trasparente; }

        /* Classi di utilità */
        .solo sr {
            posizione: assoluto;
            larghezza: 1px;
            altezza: 1px;
            imbottitura: 0;
            margine: -1px;
            troppo pieno: nascosto;
            clip: rettorato(0,0,0,0);
            spazio bianco: nowrap;
            confine: 0;
        }

        .linea-morsetto-2 {
            visualizzazione: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: verticale;
            troppo pieno: nascosto;
        }

        .morsetto-linea-3 {
            visualizzazione: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: verticale;
            troppo pieno: nascosto;
        }
    </stile>
</testa>

<corpo del corpo classe="schermo flex flex-col min-h">

    <!-- INTESTAZIONE MOBILE OTTIMIZZATA -->
    <intestazione classe="sticky top-0 z-40 bg-nero/10 sfondo-sfocatura-md bordo-b bordo-bianco/10 header-sicuro">
        <div classe="px-4 py-3">
            <div classe="flex items-center justifica-tra">
                <!-- Logo + Titolo -->
                <div classe="flex items-center gap-3">
                    <div classe="w-10 h-10 arrotondato-xl bg-bianco/20 elementi flessibili-centro giustificano-centro ombra">
                        <campata classe="testo-xl testo-bianco">️</campata>
                    </div>
                    <div>
                        <div classe="testo-bianco font-estrabold leading-nessuno text-sm md: text-base">Area Dirigenti</div>
                        <div idrato="whoami" classe="testo-bianco/80 testo-xs">Caricamento...</div>
                    </div>
                </div>

                <!-- Sezione destra -->
                <div classe="flex items-center gap-2">
                    <!-- Disconnessione desktop -->
                    <pulsante idrato="logoutBtn" classe="btn-aurora text-sm px-4 py-2 nascosto sm: flex" titolo="Disconnetti">
                        <campata>🚪</campata>
                        <campata classe="md nascosto: inline">Logout</campata>
                    </pulsante>

                    <!-- Pulsante del menu mobile -->
                    <pulsante idrato="mobileMenuBtn" classe="sm: testo touch-target nascosto-bianco p-2 arrotondato-xl bg-bianco/10">
                        <svg classe="w-5 h-5" riempire="nessuno" colpo="coloreCorrente" viewBox="002424">
                            <percorso coprilineo corsa="rotondo" stroke-linejoin="rotondo" corsa-larghezza="2" d.c="M4 6h16M4 12h16M4 18h16"></percorso>
                        </svg>
                    </pulsante>
                </div>
            </div>

            <!-- Menu mobile -->
            <div idrato="menu mobile" classe="sm: nascosto mt-4 pb-4 bordo-t bordo-bianco/20 nascosto">
                <div classe="pt-4 spazio-y-2">
                    <pulsante idrato="logoutBtnMobile" classe="btn-aurora w-full py-3 arrotondato-xl text-sm font-bold flex items-center justify-center gap-2">
                        <campata>🚪</campata>
                        <campata>Logout</campata>
                    </pulsante>
                </div>
            </div>
        </div>
    </intestazione>

    <principale classe="sezione mobile Flex-Grow max-w-6xl mx-auto w-full">

        <!-- SEZIONE EROE -->
        <sezione classe="text-center mb-6 animate-fade-in">
            <h1 classe="hero-title testo-ultra-visibile mb-2">Benvenuto nell'Area Dirigenti</h1>
            <biforcare classe="testo-bianco/90 font-semibold text-sm md:text-base">Funzioni direzionali e amministrative</biforcare>
        </sezione>

        <!-- AZIONI PERSONALI -->
        <sezione classe="scheda di vetro p-4 md: p-6 mb-6 animate-slide-up">
            <h2 classe="sezione-titolo mb-4 text-center">🧭 Azioni Personali</h2>
            <div classe="rete mobile-2">
                <un classe="scheda funzione" href="tessera.html" etichetta aria="Tessera Digitale">
                    <div classe="testo-3xl mb-1">🎫</div>
                    <h4>Tessera Digitale</h4>
                    <biforcare>Visualizza/Scarica la tua tessera</biforcare>
                </un>
                <un classe="scheda funzione" href="profilo.html" etichetta aria="Profilo">
                    <div classe="testo-3xl mb-1">👤</div>
                    <h4>Il mio profilo</h4>
                    <biforcare>Modifica i tuoi dati</biforcare>
                </un>
                <un classe="scheda funzione" href="virgilio.html" etichetta aria="Virgilio">
                    <div classe="testo-3xl mb-1">🧭</div>
                    <h4>Virgilio</h4>
                    <biforcare>il tuo chatbot professionalep>
                </un>
                <un classe="scheda funzione" href="strumenti.html" etichetta aria="Strumenti">
                    <div classe="testo-3xl mb-1">️</div>
                    <h4>Strumenti</h4>
                    <biforcare>Utility di lavoro</biforcare>
                </un>
                <un classe="scheda funzione" href="filebox.html" etichetta aria="FileBox">
                    <div classe="testo-3xl mb-1">📁</div>
                    <h4>FileBox</h4>
                    <biforcare>Area file e documenti — download</biforcare>
                </un>
                <un classe="scheda funzione" href="servizi.html" etichetta aria="Assistenza">
                    <div classe="testo-3xl mb-1">🛟</div>
                    <h4>Assistenza</h4>
                    <biforcare>Supporto e servizi</biforcare>
                </un>
                <un classe="scheda funzione" href="https://form.jotform.com/243226223182044" bersaglio="_vuoto" rel="noopener">
                    <div classe="testo-3xl mb-1">💰</div>
                    <h4>Richiedi Rimborso</h4>
                    <biforcare>Modulo rimborso spese</biforcare>
                </un>
                <un classe="scheda funzione" href="https://form.jotform.com/243262801203343" bersaglio="_vuoto" rel="noopener">
                    <div classe="testo-3xl mb-1">📝</div>
                    <h4>Richiedi Permesso</h4>
                    <biforcare>Permesso sindacale</biforcare>
                </un>
                <un classe="scheda funzione" href="https://eu.jotform.com/tables/243226223182044" bersaglio="_vuoto" rel="noopener">
                    <div classe="testo-3xl mb-1">📊</div>
                    <h4>Tabella Rendiconto</h4>
                    <biforcare>Visualizza i dati</biforcare>
                </un>
                <un classe="scheda funzione" href="https://eu.jotform.com/tables/243262801203343" bersaglio="_vuoto" rel="noopener">
                    <div classe="testo-3xl mb-1">📅</div>
                    <h4>Tabella Permessi</h4>
                    <biforcare>Gestisci permessi</biforcare>
                </un>

                <un classe="scheda funzione" href="Academy.html" etichetta aria="Community Hub (Novità)">
                    <campata classe="badge assoluto top-2 destra-2">⭐ NOVITÀ</campata>
                    <div classe="testo-3xl mb-1">🎓</div>
                    <h4>Hub comunitario</h4>
                    <biforcare>Vai all'Academy interattiva</biforcare>
                </un>
</div>
        </sezione>

        <!-- DATI DIRIGENZIALI -->
        <sezione classe="scheda di vetro p-4 md: p-6 mb-6 animate-slide-up">
            <h2 classe="sezione-titolo mb-4 text-center">🪪 I Tuoi Dati dirigenziali</h2>
            <div classe="flex flex-col sm: flex-row items-center justify-center gap-4 text-center sm: text-left">
                <div classe="w-14 h-14 arrotondato-completo bg-slate-800 testo-bianco elementi flessibili-centro di giustificazione-centro di testo-2xl flex-shrink-0">
                    <campata idrato="icona utente">👤</campata>
                </div>
                <div>
                    <div idrato="userName" classe="text-lg md: text-xl font-extrabold text-slate-900 mb-1">Caricamento...</div>
                    <div idrato="e-mail dell'utente" classe="text-slate-600 text-sm mb-2">—</div>
                    <div classe="flex flex-wrap justify-center sm: justify-start gap-2">
                        <campata classe="px-3 py-1 arrotondato-completo bg-slate-100 testo-slate-800 testo-xs">
                            📅 <campata classe="nascosto sm: inline">Iscritto dal:</campata> <forte idrato="iscrittoDal">—</forte>
                        </campata>
                        <campata classe="px-3 py-1 arrotondato-completo bg-slate-100 testo-slate-800 testo-xs">
                            🔐 <forte idrato="accessoLivello">Verifica...</forte>
                        </campata>
                    </div>
                </div>
            </div>
        </sezione>

        <!-- PANORAMICA SISTEMA -->
        <sezione classe="scheda di vetro p-4 md: p-6 mb-6 animate-slide-up">
            <h2 classe="sezione-titolo mb-4 text-center">📈 Panoramica di sistema</h2>
            <div classe="stats-grid">
                <div classe="p-4 arrotondato-xl bordo bordo bordo-ardesia-200 bg-bianco testo-centro">
                    <div classe="testo-2xl mb-1">📰</div>
                    <div classe="testo-xs text-slate-600 mb-1">News pubblica</div>
                    <div idrato="newsCount" classe="testo-2xl font-extrabold text-slate-900">—</div>
                </div>
                <div classe="p-4 arrotondato-xl bordo bordo bordo-ardesia-200 bg-bianco testo-centro">
                    <div classe="testo-2xl mb-1">⭐</div>
                    <div classe="testo-xs text-slate-600 mb-1">News in evidenza</div>
                    <div idrato="featuredNewsCount" classe="testo-2xl font-extrabold text-slate-900">—</div>
                </div>
                <div classe="p-4 arrotondato-xl bordo bordo bordo-ardesia-200 bg-bianco testo-centro">
                    <div classe="testo-2xl mb-1">️</div>
                    <div classe="testo-xs text-slate-600 mb-1">Ruolo</div>
                    <div idrato="riepilogo ruoli" classe="font text-sm-testo grassetto-slate-900">—</div>
                </div>
                <div classe="p-4 arrotondato-xl bordo bordo bordo-ardesia-200 bg-bianco testo-centro">
                    <div classe="testo-2xl mb-1">️</div>
                    <div classe="testo-xs text-slate-600 mb-1">Stato</div>
                    <div classe="testo-sm carattere-grassetto testo-verde-600">Attivo</div>
                </div>
            </div>
        </sezione>

        <!-- AREA AMMINISTRATIVA -->
        <sezione classe="scheda di vetro p-4 md: p-6 mb-6 animate-slide-up">
            <h2 classe="sezione-titolo mb-4 text-center">️ Area Amministrativa dirigenziale</h2>
            <div classe="admin-grid">
               <un href="gestione_richieste_utenti.html" classe="scheda funzione">
    <div classe="testo-4xl mb-2">📋</div>
    <h4>Gestione Richieste Utenti</h4>
    <biforcare>Gestisci le ricchezze degli utensili</biforcare>
</un>
                <un href="gestione-convenzioni.html" classe="scheda funzione">
                    <div classe="testo-4xl mb-2">️</div>
                    <h4>Gestione Convenzioni</h4>
                    <biforcare>Partenariato Crea e gestisci</biforcare>
                </un>
                <un href="gestione-notizie.html" classe="scheda funzione">
                    <div classe="testo-4xl mb-2">📰</div>
                    <h4>Gestione Notizie</h4>
                    <biforcare>Pubblica e modifica news</biforcare>
                </un>

                <un href="admin-academy.html" classe="scheda funzione">
                    <campata classe="badge assoluto top-2 destra-2">⭐ NOTIZIE</campata>
                    <div classe="testo-4xl mb-2">🎓</div>
                    <h4>Polo Comunitario Gestione</h4>
                    <biforcare>Accademia Gestisci & amp; Comunità</biforcare>
                </un>
</div>
        </sezione>

        <!-- ULTIME NOTIZIE -->
        <sezione classe="scheda di vetro p-4 md: p-6 mb-6 animate-slide-up">
            <h2 classe="sezione-titolo mb-4 text-center">️ Ultime Notizie</h2>
            <div idrato="ultimeNotizie" classe="news-grid">
                <div classe="col-span-full flex items-center justification-center py-8">
                    <campata classe="filatore"></campata>
                </div>
            </div>
            <div idrato="newsEmptyState" classe="centro-testo nascosto py-8">
                <div classe="testo-4xl mb-3">🪧</div>
                <biforcare classe="carattere text-slate-700-semibold">Nessuna notizia pubblica al momento</biforcare>
            </div>
        </sezione>

        <!-- CONVENZIONI IN EVIDENZA -->
        <sezione classe="scheda di vetro p-4 md: p-6 mb-6 animate-slide-up">
            <h2 classe="sezione-titolo mb-4 text-center">🤝 Convenzioni in evidenza</h2>
            <div idrato="featuredConvenzioni" classe="news-grid"></div>
            <div idrato="convEmptyState" classe="centro testo py-8">
                <div classe="testo-4xl mb-3">🔎</div>
                <biforcare classe="carattere text-slate-700-semibold">Al momento non ci sono convenzioni in evidenza.</biforcare>
                <biforcare classe="text-slate-500 mt-1 text-sm">
                    Gestiscile da <un classe="sottolineatura carattere-grassetto testo-blu-700" href="gestione-convenzioni.html">Gestione Convenzioni</un>.
                </biforcare>
            </div>
        </sezione>

    </principale>

    <!-- JAVASCRIPT -->
    <scrittura tipo="modulo">
        importare { creaCliente } da 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

        cospetto supabase = creaCliente(
            'https://pvzdilkozpspsnepedqc.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB2emRpbGtvenBzcHNuZXBlZHFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ1MDY1NDUsImV4cCI6MjA3MDA4MjU0NX0.JimqeUkyOGcOw-pt-yJUVevSP3n6ikBPDR3N8y_7YIk'
        );

        // Stato del menu mobile
        lasciar perdere mobileMenuApri = falso;

        // Funzioni di utilità
        cospetto fmtDate = (iso) => { 
            prova { 
                ritorno iso ? nuovo Intl.DataTimeFormato('esso-ESSO', {dataStyle: 'lungo'}).formato(nuovo Data(iso)) : '—'; 
            } cattura { 
                ritorno '—'; 
            } 
        };

        cospetto escapeHTML = (s) => Corda(s ?? ').sostituisci tutto('&','&amp;').sostituisci tutto('<','&lt;').sostituisci tutto('>','&gt;').sostituisci tutto('"','& quot;').sostituisci tutto("',"&#39;");

        cospetto setText = (idrato, v) => { 
            cospetto el = documento.getElementById(idrato); 
            se (el) el.contenuto del testo = v; 
        };

        // Funzioni del menu mobile
        funzione setupMobileMenu() {
            cospetto mobileMenuBtn = documento.getElementById('mobileMenuBtn');
            cospetto menu mobile = documento.getElementById("menu mobile");

            se (mobileMenuBtn && menu mobile) {
                mobileMenuBtn.addEventListener('clicca', toggleMobileMenu);

                // Chiudere il menu quando si fa clic all'esterno
                documento.addEventListener('clicca', (e) => {
                    se (!mobileMenuBtn.contiene(e.bersaglio) && !menu mobile.contiene(e.bersaglio)) {
                        chiudiMenumobile();
                    }
                });
            }
        }

        funzione toggleMobileMenu() {
            cospetto menu mobile = documento.getElementById("menu mobile");
            cospetto mobileMenuBtn = documento.getElementById('mobileMenuBtn');

            se (menu mobile) {
                mobileMenuApri = !mobileMenuApri;

                se (mobileMenuApri) {
                    menu mobile.elenco classi.rimuovere('nascosto');
                    menu mobile.elenco classi.aggiungere("scivolamento degli animati");
                    se (mobileMenuBtn) {
                        mobileMenuBtn.html interno = `
                            <classe SVG="w-5 h-5" riempimento="nessuno" tratto="currentColor" visualizzazioneBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        `;
                    }
                } altro {
                    menu mobile.elenco classi.aggiungere('nascosto');
                    menu mobile.elenco classi.rimuovere("scivolamento degli animati");
                    se (mobileMenuBtn) {
                        mobileMenuBtn.html interno = `
                            <classe SVG="w-5 h-5" riempimento="nessuno" tratto="currentColor" visualizzazioneBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                        `;
                    }
                }
            }
        }

        funzione chiudiMenumobile() {
            se (mobileMenuApri) {
                toggleMobileMenu();
            }
        }

        //Guardia di autenticazione
        asincronizzare funzione guardia() {
            cospetto { dati: { utente } } = attendere supabase.aut.ottieni utente();
            se (!utente) { 
                finestra.località.href = "auth.html"; 
                ritorno nullo; 
            }
            ritorno utente;
        }

        // Carica il profilo utente
        asincronizzare funzione loadProfile(utente) {
            prova {
                cospetto { dati: biforcare } = attendere supabase.da("profili_utente").selezionare("nome, nome, e-mail, ruolo").eq('utente_id', utente.idrato).singolo();
                setText('whoami', biforcare?.email || utente.email || '—');
                setText('nomeutente', biforcare?.nome ? `${biforcare.nome} ${biforcare.cognome||'}`.rifinitura() : 'Dirigente');
                setText('userEmail', biforcare?.email || utente.email || '—');
                documento.getElementById('icona utente').contenuto del testo = (biforcare?.ruolo === 'AMMINISTRARE') ? '👑' : '🎯';
                setText("rolesSummary", biforcare?.ruolo || '—');
                setText('accessLevel', biforcare?.ruolo === 'AMMINISTRARE' ? ‘Accesso Amministratore Completo’ : ‘Accesso Dirigente Autorizzato’);
            } cattura {
                setText('whoami', utente.email || '—');
                setText('nomeutente', 'Dirigente'); 
                setText('userEmail', utente.email || '—'); 
                setText("rolesSummary", '—'); 
                setText('accessLevel', ‘Accesso Dirigente Autorizzato’);
            }
        }

        // Data di sottoscrizione del carico
        asincronizzare funzione loadIscrittoDal(utente) {
            prova {
                cospetto { dati } = attendere supabase.da('tessere').selezionare("dati_emissioni").eq('utente_id', utente.idrato).ordine("dati_emissioni", { ascendente: vero }).limite(1);
                setText('iscrittoDal', dati?.[0]?.data_emissione ? fmtDate(dati[0].data_emissione) : "Non disponibile");
            } cattura { 
                setText('iscrittoDal', "Non disponibile"); 
            }
        }

        // Panoramica del sistema di carico
        asincronizzare funzione loadSystemOverview() {
            prova {
                cospetto nowIso = nuovo Data().toISOString();
                cospetto { contare: totalNews } = attendere supabase.da("notizie").selezionare('io', {contare: 'esatto', testa: vero}).eq('pubblicata', vero).o(`data_scadenza.is.null,data_scadenza.gt.${nowIso}`);
                cospetto { contare: featuredCount } = attendere supabase.da("notizie").selezionare('io', {contare: 'esatto', testa: vero}).eq('pubblicata', vero).eq('in_evidenza', vero).o(`data_scadenza.is.null,data_scadenza.gt.${nowIso}`);
                setText('notizieCount', typeof totalNews === 'numero' ? totalNews : '—'); 
                setText('featuredNewsCount', typeof featuredCount === 'numero' ? featuredCount : '—');
            } cattura { 
                setText('notizieCount', '—'); 
                setText('featuredNewsCount', '—'); 
            }
        }

        //Carica le ultime notizie
        asincronizzare funzione caricaUltimeNotizie() {
            cospetto avvolgere = documento.getElementById("ultime notizie"); 
            cospetto vuoto = documento.getElementById('notizieEmptyState');

            avvolgere.html interno = `<div class="col-span-full flex items-center justify-center py-8"><span class="spinner"></span></div>`;

            prova {
                cospetto nowIso = nuovo Data().toISOString();
                cospetto { dati: notizie } = attendere supabase
                    .da("notizie")
                    .selezionare('id,titolo,sottotitolo,immagine_url,categoria,data_pubblicazione,in_evidenza,url_articolo')
                    .eq('pubblicata', vero)
                    .o(`data_scadenza.is.null,data_scadenza.gt.${nowIso}`)
                    .ordine('in_evidenza', {ascendente: falso})
                    .ordine('data_pubblicazione', {ascendente: falso})
                    .limite(6);

                se (!notizie || !notizie.lunghezza) { 
                    avvolgere.html interno = '; 
                    vuoto.elenco classi.rimuovere('nascosto'); 
                    ritorno; 
                }

                vuoto.elenco classi.aggiungere('nascosto'); 
                avvolgere.html interno = ';

                per (cospetto n di notizie) {
                    cospetto carta = documento.creaelemento('articolo');
                    cospetto hasUrl = !!n.url_articolo && Corda(n.url_articolo).rifinitura().lunghezza > 0;
                    carta.nomeclasse = "bordo con bordo arrotondato xl-ardesia-200 bg-ombra nascosta con overflow bianco-sm";
                    carta.html interno = `
                        <classe Div="h-32 md:h-40 bg-slate-100 overflow-nascosto">
                            ${n.immagine_url ? 
                                `<img src="${escapeHTML(n.immagine_url)}"alt="" class="w-full h-full object-cover">` : 
                                `<div class="w-full h-full flex items-center justify-center text-3xl md:text-4xl">📰</div>`
                            }
                        </div>
                        <classe Div="p-3 md:p-4">
                            <classe Div="flex items-center justification-between mb-2">
                                <classe di campata="badge">${escapeHTML(n.categoria || "GENERALE")}</span>
                                ${n.in_evidenza ? '<classe campata="badge">⭐ In evidenza</span>' : '}
                            </div>
                            <classe h3="font-extrabold text-slate-900 text-sm md:text-lg leading-snug mb-1">${escapeHTML(n.titolo)}</h3>
                            ${n.sottotitolo ? `<p class="text-slate-600 text-xs md:text-sm mb-3">${escapeHTML(n.sottotitolo)}</p>` : '}
                            <div class="flex items-center justify-between text-xs text-slate-500">
                                <span>${fmtDate(n.data_pubblicazione)}</span>
                                <classe di pulsanti="btn-aurora text-xs px-3 py-2" ${hasUrl ? `data-url="${escapeHTML(n.url_articolo)}"` : ‘titolo disabilitato="Nessun link"’}>Leggi l'articolo completo</button>
                            </div>
                        </div>`;
                    avvolgere.appendChild(carta);
                }

                avvolgere.addEventListener('clicca', (e) => { 
                    cospetto b = e.bersaglio.più vicino('pulsante[data-url]'); 
                    se (b) { 
                        finestra.aperto(b.getAttribute("dati-url"), '_vuoto', 'noopener'); 
                    } 
                }, { una volta: vero });
            } cattura (e) { 
                console.errore(e); 
                avvolgere.html interno = '<div class="text-center py-8 text-slate-600">Errore nel caricamento</div>'; 
            }
        }

        //Carica le convenzioni in primo piano
        asincronizzare funzione loadFeaturedConvenzioni() {
            cospetto avvolgere = documento.getElementById(‘featuredConvenzioni’); 
            cospetto vuoto = documento.getElementById("convEmptyState");

            prova {
                cospetto { dati } = attendere supabase.da(‘convenzioni’)
                    .selezionare('id,nome_attesa,descrizione,logo_url,link_esterno,in_evidenza,attesa')
                    .eq('attiva', vero)
                    .eq('in_evidenza', vero)
                    .ordine('creato_at', {ascendente: falso})
                    .limite(6);

                se (!dati || !dati.lunghezza) { 
                    vuoto.elenco classi.rimuovere('nascosto'); 
                    ritorno; 
                }

                vuoto.elenco classi.aggiungere('nascosto'); 
                avvolgere.html interno = ';

                per (cospetto c di dati) {
                    cospetto el = documento.creaelemento('a');
                    el.nomeclasse = ‘funzione-carta bordo-slate-200 bg-bianco’;
                    el.href = c.link_esterno || '#'; 
                    el.bersaglio = c.link_esterno ? '_vuoto' : '_sé'; 
                    el.rel = c.link_esterno ? 'noopener' : ';
                    el.html interno = `
                        <classe Div="w-full h-16 md: h-24 bg-slate-50 arrotondato-lg flex items-center justify-center overflow-hidden mb-3">
                            ${c.logo_url ? `<img src="${escapeHTML(c.logo_url)}"alt="" class="max-h-16 md:max-h-24 oggetto-contenere">` : '<div class="text-2xl md:text-3xl">🤝</div>'}
                        </div>
                        <classe h4="font-extrabold">${escapeHTML(c.nome_aziende)}</h4>
                        <classe p="text-slate-600 text-xs">${escapeHTML((c.descrizione||').fetta(0,110))}${c.descrizione&&c.descrizione.lunghezza>110?'...':'}</p>`;
                    avvolgere.appendChild(el);
                }
            } cattura { 
                vuoto.elenco classi.rimuovere('nascosto'); 
            }
        }

        // Funzioni di disconnessione
        funzione configurazioneLogout() {
            cospetto logoutBtns = ['logoutBtn', 'logoutBtnMobile'];
            logoutBtns.forEach(idrato => {
                cospetto btn = documento.getElementById(idrato);
                se (btn) {
                    btn.addEventListener('clicca', handleLogout);
                }
            });
        }

        asincronizzare funzione handleLogout() {
            prova { 
                attendere supabase.aut.firma(); 
            } cattura {}
            finestra.località.href = 'index.html';
        }

        // Ottimizzazioni mobili
        funzione setupMobileOttimizzazioni() {
            // Modifiche all'orientamento della maniglia
            finestra.addEventListener("cambiamento di orientamento", () => {
                setTimeout(() => {
                    chiudiMenumobile();
                }, 100);
            });

            //Gestire lo scorrimento per nascondere il menu mobile
            lasciar perdere lastScrollY = finestra.scrolly;
            finestra.addEventListener('scorrere', () => {
                cospetto scorrimento corrente = finestra.scrolly;
                se (scorrimento corrente > lastScrollY + 50) {
                    chiudiMenumobile();
                }
                lastScrollY = scorrimento corrente;
            });

            // Aggiungi ridimensiona ascoltatore per aggiornare i layout
            finestra.addEventListener('ridimensionare', () => {
                //Chiudi il menu mobile ridimensionando lo schermo più grande
                se (finestra.larghezza interna >= 640) {
                    chiudiMenumobile();
                }
            });
        }

        // Inizializza tutto
        (asincronizzare () => {
            console.log(' ️ Area Dirigenti Mobile-First Dashboard Loading...');

            //Imposta interazioni mobili
            setupMobileMenu();
            configurazioneLogout();
            setupMobileOttimizzazioni();

            // Controlla l'autenticazione
            cospetto utente = attendere guardia(); 
            se (!utente) ritorno;

            //Carica tutti i dati
            attendere Promettere.tutto([
                loadProfile(utente), 
                loadIscrittoDal(utente), 
                loadSystemOverview(), 
                caricaUltimeNotizie(), 
                loadFeaturedConvenzioni()
            ]);

            console.log(‘✅ Area Dirigenti Dashboard Ready - Mobile Ottimizzato con Piena Integrazione’);
        })();
    </scrittura>

    <!-- Sezione riepilogativa del Community Hub --></corpo del corpo>
</html>
